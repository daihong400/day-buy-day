$(function(){
    var dataMap=[
        {
            "id":"ba410aec-166c-469c-8164-52d07ff5852b",
            "name":"\u98CE\u9669\u7BA1\u7406",
            "desc":"\u5408\u89C4\u98CE\u9669\u81EA\u8BC4",
            "forNavigation":true,
            "companyId":"deloitte",
            "url":null,
            "icon":" url(>skin>common\/icons.gif) -220px -60px",
            "parentId":null,
            "order":null,
            "systemId":null,
            "use":false,
            "target":null,
            "hasChild":false,
            "children":[
                {
                    "id":"3b1f8173-99fa-4d28-a92b-3348bac39c9a",
                    "name":"\u5DE5\u4F5C\u6A21\u677F\u7BA1\u7406",
                    "desc":"${res[\"risk.language\/menue_work_template_management\"]}",
                    "forNavigation":true,
                    "companyId":"deloitte",
                    "url":null,
                    "icon":" url(>skin>common\/icons.gif) -280px -60px",
                    "parentId":"ba410aec-166c-469c-8164-52d07ff5852b",
                    "order":null,
                    "systemId":null,
                    "use":false,
                    "target":null,
                    "hasChild":false,
                    "children":[
                        {
                            "id":"d330d87a-f187-4115-bb48-6323cde0a4b6",
                            "name":"\u5DE5\u4F5C\u6A21\u677F-\u521B\u5EFA",
                            "desc":"${res[\"risk.language\/menue_work_template_add\"]}",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"com.deloitte.risk.rr.view.RRTemplateManager.ling",
                            "icon":" url(>skin>common\/icons.gif) -260px -140px",
                            "parentId":"3b1f8173-99fa-4d28-a92b-3348bac39c9a",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"e0cdb94c-9e15-48e8-8af1-5cbd3e8e93c7",
                            "name":"\u5DE5\u4F5C\u6A21\u677F-\u4FEE\u8BA2",
                            "desc":"${res[\"risk.language\/menue_work_template_modify\"]}",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"com.deloitte.risk.rr.view.RRTemplateModify.ling",
                            "icon":" url(>skin>common\/icons.gif) -260px -140px",
                            "parentId":"3b1f8173-99fa-4d28-a92b-3348bac39c9a",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        }
                    ]
                },
                {
                    "id":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                    "name":"\u98CE\u9669\u8BC4\u4F30",
                    "desc":"\u98CE\u9669\u8BC4\u4F30",
                    "forNavigation":true,
                    "companyId":"deloitte",
                    "url":null,
                    "icon":" url(>skin>common\/icons.gif) -220px -140px",
                    "parentId":"ba410aec-166c-469c-8164-52d07ff5852b",
                    "order":null,
                    "systemId":null,
                    "use":false,
                    "target":null,
                    "hasChild":false,
                    "children":[
                        {
                            "id":"625dfe15-3ba3-4fff-aaa8-99ea8654767e",
                            "name":"\u5DE5\u4F5C\u8BA1\u5212-\u521B\u5EFA",
                            "desc":"\u98CE\u9669\u8BC4\u4F30\u8BA1\u5212\u7BA1\u7406",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.plan.view.PlanMainInfoManager_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -0px -120px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"f20a497e-4825-4c40-a572-383231d5878e",
                            "name":"\u5DE5\u4F5C\u8BA1\u5212-\u5BA1\u6279",
                            "desc":null,
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.plan.view.PlanMainInfoApprove_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -20px -0px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"13b597b9-59be-48c2-821e-2eca973d2db9",
                            "name":"\u5DE5\u4F5C\u8BA1\u5212-\u76D1\u63A7",
                            "desc":null,
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.rcsa.view.RCSAPlanMainInfoMonitor_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -260px -60px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"3c46ddd4-d7b9-4db9-ac28-34d9b7bf5451",
                            "name":"\u98CE\u9669\u8BC4\u4F30-\u6267\u884C",
                            "desc":"\u5408\u89C4\u98CE\u9669\u81EA\u8BC4\u6267\u884C",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.rcsa.view.ExecuteSelfAssessmentRiskControl_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -300px -60px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"3581ddf1-88ce-41c0-9786-f88dc7060411",
                            "name":"\u98CE\u9669\u8BC4\u4F30-\u5BA1\u6279",
                            "desc":"\u5408\u89C4\u98CE\u9669\u81EA\u8BC4-\u5BA1\u6279",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.rcsa.view.ApproveSelfAssessmentRiskControl_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -300px -60px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"a0d29bae-5c63-4f51-be81-ad080de0fe1c",
                            "name":"\u98CE\u9669\u8BC4\u4F30-\u8DDF\u8FDB",
                            "desc":null,
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.rcsa.view.CheckSelfAssessmentRiskControl_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -60px -20px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"43014e89-58d7-4135-96fd-8a8bf29a590b",
                            "name":"\u98CE\u9669\u8BC4\u4F30-\u67E5\u770B",
                            "desc":null,
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.rcsa.view.ViewSelfAssessmentRiskControl_CITIC.ling",
                            "icon":" url(>skin>common\/icons.gif) -20px -40px",
                            "parentId":"35baa1dd-c851-4a89-a174-8cf4fa649baa",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        }
                    ]
                },
                {
                    "id":"751b5217-60f8-4f91-b734-62a1522123ec",
                    "name":"\u91D1\u878D_\u4EA4\u6613\u5BF9\u624B\u62A5\u544A  ",
                    "desc":null,
                    "forNavigation":true,
                    "companyId":"deloitte",
                    "url":null,
                    "icon":"  url(>skin>common\/icons.gif) -60px -160px",
                    "parentId":"ba410aec-166c-469c-8164-52d07ff5852b",
                    "order":null,
                    "systemId":null,
                    "use":false,
                    "target":null,
                    "hasChild":false,
                    "children":[
                    ]
                }
            ]
        },
        {
            "id":"9f40826c-4c65-44ad-9e97-71a1613bf65b",
            "name":"\u5408\u89C4\u7BA1\u7406",
            "desc":null,
            "forNavigation":true,
            "companyId":"deloitte",
            "url":null,
            "icon":"url(>skin>common\/icons.gif) -60px -160px",
            "parentId":null,
            "order":null,
            "systemId":null,
            "use":false,
            "target":null,
            "hasChild":false,
            "children":[
                {
                    "id":"7d9ec3ff-2358-4a00-bf8f-d473d3698e6c",
                    "name":"\u5408\u89C4\u95EE\u7B54",
                    "desc":"\u5408\u89C4\u95EE\u7B54",
                    "forNavigation":true,
                    "companyId":"deloitte",
                    "url":null,
                    "icon":" url(>skin>common\/icons.gif) -180px -0px",
                    "parentId":"9f40826c-4c65-44ad-9e97-71a1613bf65b",
                    "order":null,
                    "systemId":null,
                    "use":false,
                    "target":null,
                    "hasChild":false,
                    "children":[
                        {
                            "id":"e7ec8931-d49d-4225-ad92-3a293f449adf",
                            "name":"\u5408\u89C4\u63D0\u95EE",
                            "desc":"",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.interlocution.view.InterlocutionManager.ling",
                            "icon":" url(>skin>common\/icons.gif) -120px -60px",
                            "parentId":"7d9ec3ff-2358-4a00-bf8f-d473d3698e6c",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"2e3c6969-04e7-432b-8787-bb37ebb65f9f",
                            "name":"\u5408\u89C4\u56DE\u7B54",
                            "desc":null,
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"com.deloitte.risk.interlocution.view.InterlocutionManagerAnswer.ling",
                            "icon":" url(>skin>common\/icons.gif) -280px -60px",
                            "parentId":"7d9ec3ff-2358-4a00-bf8f-d473d3698e6c",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        },
                        {
                            "id":"f811574d-7984-426c-90b1-79350cea6274",
                            "name":"\u5408\u89C4\u6307\u6D3E",
                            "desc":"\u5408\u89C4\u6307\u6D3E",
                            "forNavigation":true,
                            "companyId":"deloitte",
                            "url":"risk.interlocution.view.InterlocutionManagerAssign.ling",
                            "icon":" url(>skin>common\/icons.gif) -120px -120px",
                            "parentId":"7d9ec3ff-2358-4a00-bf8f-d473d3698e6c",
                            "order":null,
                            "systemId":null,
                            "use":false,
                            "target":null,
                            "hasChild":false,
                            "children":[
                            ]
                        }
                    ]
                }
            ]
        },{
            "id":"a172a165-0d0d-4ae5-a489-dd3229101a0d",
            "name":"\u6CD5\u5F8B\u6848\u4EF6\u7BA1\u7406",
            "desc":"\u6848\u4EF6\u7BA1\u7406",
            "forNavigation":true,
            "companyId":"deloitte",
            "url":null,
            "icon":"url(>skin>common\/icons.gif) -60px -160px",
            "parentId":null,
            "order":null,
            "systemId":null,
            "use":false,
            "target":null,
            "hasChild":false,
            "children":[
            ]
        },
    ]

    // 左侧菜单加载
    function deepEach(data, elem) {
        $.each(data, function(index, value){
            if(value.children.length === 0) {
                var html = '<li><a href="javascript:;" data-href="'+ value.url +'" class="afinve"><span class="">'+ value.name +'</span></a></li>';
                elem.append(html);
            } else {
                var html = '<li><a href="javascript:;" class="afinve"> <span class="arrow"></span><span class="">'+ value.name +'</span></a>';
                var newIndex = value.id;
                elem.append(html+ '<ul class="sub-menu" id='+ newIndex +'>');
                deepEach(value.children, $("#"+ newIndex));
                elem.append("</ul></li>");
            }
        });
    }

    $("#navMenu").html("");
    deepEach(dataMap, $("#navMenu"));

    // nav收缩展开
    $('.navMenu li a').on('click', function () {
        var parent = $(this).parent().parent();//获取当前页签的父级的父级
        var labeul = $(this).parent("li").find(">ul")
        if ($(this).parent().hasClass('open') == false) {
            //展开未展开
            parent.find('ul').slideUp(300);
            parent.find("li").removeClass("open")
            parent.find('li a').removeClass("active").find(".arrow").removeClass("open")
            $(this).parent("li").addClass("open").find(labeul).slideDown(300);
            $(this).addClass("active").find(".arrow").addClass("open")
        } else {
            $(this).parent("li").removeClass("open").find(labeul).slideUp(300);
            if ($(this).parent().find("ul").length > 0) {
                $(this).removeClass("active").find(".arrow").removeClass("open")
            } else {
                $(this).addClass("active")
            }
        }

    });

    $('.navMenu li a').click(function(){
        if($(this).attr('data-href') !== 'null' && $(this).attr('data-href') !== undefined) {
            alert($(this).attr('data-href'))
        }
    })

    //初始化热力图
    heatMapInit();
    function heatMapInit() {
        var myChart = echarts.init(document.getElementById('heatMap'));
        var hours = ['有效', '', '管控有效性', '','无效'];
        var days = ['高', '', '固有风险',
            '', '低'];

        var data = [[0,0,1],[0,1,2],[0,2,4],[0,3,4],[0,4,4],[1,1,4],[1,0,4]];
        data = data.map(function (item) {
            return [item[1], item[0], item[2] || '-'];
        });

        option = {
            tooltip: {
                position: 'top'
            },
            animation: false,
            grid: {
                height: '50%',
                y: '10%'
            },
            xAxis: {
                type: 'category',
                data: hours,
                splitArea: {
                    show: true
                }
            },
            yAxis: {
                type: 'category',
                data: days,
                splitArea: {
                    show: true
                }
            },
            visualMap: {
                min: 0,
                max: 10,
                calculable: true,
                orient: 'horizontal',
                left: 'center',
                bottom: '15%'
            },
            series: [{
                name: 'Punch Card',
                type: 'heatmap',
                data: data,
                label: {
                    normal: {
                        show: true
                    }
                },
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }]
        };
        myChart.setOption(option);
    }

    //初始化雷达图
    radarInit();
    function radarInit() {
        var myChart = echarts.init(document.getElementById('radarMap'));
        option = {
            radar: {
                // shape: 'circle',
                name: {
                    textStyle: {
                        color: '#fff',
                        backgroundColor: '#999',
                        // borderRadius: 3,
                        padding: [3, 5]
                    }
                },
                indicator: [
                    { name: '战略风险', max: 6500},
                    { name: '市场风险', max: 16000},
                    { name: '法律风险', max: 30000},
                    { name: '财务风险', max: 38000},
                    { name: '运营风险', max: 52000},
                    { name: '市场风险', max: 25000}
                ]
            },
            series: [{
                name: '预算 vs 开销（Budget vs spending）',
                type: 'radar',
                areaStyle: {normal: {
                        color:"#4b9df9",
                        type: 'default',
                        opacity: '1'
                    }},
                itemStyle: {
                    normal: {
                        lineStyle: {
                            color :"#87cefa",
                            width : 2
                        }
                    }
                },
                data : [
                    {
                        value : [4300, 10000, 28000, 35000, 50000, 19000],
                        name : '预算分配（Allocated Budget）'
                    }
                ]
            }]
        };
        myChart.setOption(option);
    }

    //初始化柱状图1
    barOneInit();
    function barOneInit() {
        var myChart = echarts.init(document.getElementById('barMap1'));
        option = {
            color: ['#3398DB'],
            tooltip : {
                trigger: 'axis',
                axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                    type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '9%',
                bottom: '8%',
                containLabel: true
            },
            xAxis : [
                {
                    type : 'category',
                    data : ['中信建投', '中国中信股份有限公司', '中信建投证券', '中信证券', '中信资本'],
                    axisLabel: {
                        interval:0,
                        rotate:-40
                    },
                    axisTick: {
                        alignWithLabel: true
                    }
                }
            ],
            yAxis : [
                {
                    type : 'value'
                }
            ],
            series : [
                {
                    name:'直接访问',
                    type:'bar',
                    barWidth: '50%',
                    data:[10, 52, 200, 334, 390],
                    barCategoryGap : '60%',
                    barMinHeight: 20,
                    barMaxWidth: 60,
                    markLine : {
                        itemStyle: {
                            normal: {
                                color:'#FA8565',
                                label: {
                                    formatter: '{b}'
                                }
                            }
                        },
                        data : [
                            {type : 'average',
                                name: '平均线'
                            }
                        ]
                    }

                }
            ]
        };
        myChart.setOption(option);
    }

    //初始化柱状图2
    barTwoInit();
    function barTwoInit() {
        var myChart = echarts.init(document.getElementById('barMap2'));
        option = {
            color: ['#3398DB'],
            tooltip : {
                trigger: 'axis',
                axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                    type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '9%',
                bottom: '8%',
                containLabel: true
            },
            xAxis : [
                {
                    type : 'category',
                    data : ['中信建投', '中国中信股份有限公司', '中信建投证券', '中信证券', '中信资本'],
                    axisLabel: {
                        interval:0,
                        rotate:-40
                    },
                    axisTick: {
                        alignWithLabel: true
                    }
                }
            ],
            yAxis : [
                {
                    type : 'value'
                }
            ],
            series : [
                {
                    name:'直接访问',
                    type:'bar',
                    barWidth: '50%',
                    data:[10, 52, 200, 334, 390],
                    barCategoryGap : '60%',
                    barMinHeight: 20,
                    barMaxWidth: 60,
                    markLine : {
                        itemStyle: {
                            normal: {
                                color:'#FA8565',
                                label: {
                                    formatter: '{b}'
                                }
                            }
                        },
                        data : [
                            {type : 'average',
                                name: '平均线'
                            }
                        ]
                    }

                }
            ]
        };
        myChart.setOption(option);
    }

    //初始化饼型图
    pieInit();
    function pieInit() {
        var myChart = echarts.init(document.getElementById('pieMap'));
        option = {
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                bottom: 10,
                left: 'center',
                data: ['安全生产','信息安全','违法违纪','负面报道','其他']
            },
            color: ['#4B9DF9','#f5c903','#3dc999','#f95151','#a0a0a0'],
            series : [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius : '55%',
                    center: ['50%', '60%'],
                    label: {
                        normal: {
                            position: 'inner',
                            formatter: "{d}%"
                        }
                    },
                    data:[
                        {value:335, name:'安全生产'},
                        {value:310, name:'信息安全'},
                        {value:234, name:'违法违纪'},
                        {value:300, name:'负面报道'},
                        {value:1548, name:'其他'}
                    ],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);
    }

}());